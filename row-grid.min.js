var rowGrid=function(f,b){function u(g){for(var d=[g];(g=g.nextSibling)&&9!==g.nodeType;)1===g.nodeType&&d.push(g);return d}function n(g,d,b){var f=0,e=[];b=Array.prototype.slice.call(b||g.querySelectorAll(d.itemSelector));var r=b.length;singleImagePerRow=!!window.matchMedia&&!window.matchMedia("(min-width:"+d.minWidth+"px)").matches;var h=getComputedStyle(g);g=Math.floor(g.getBoundingClientRect().width)-parseFloat(h.getPropertyValue("padding-left"))-parseFloat(h.getPropertyValue("padding-right"));
h=[];for(var c,k,q,a=0;a<r;++a)(c=b[a].getElementsByTagName("img")[0])?((k=parseInt(c.getAttribute("width")))||c.setAttribute("width",k=c.offsetWidth),(q=parseInt(c.getAttribute("height")))||c.setAttribute("height",q=c.offsetHeight),h[a]={width:k,height:q}):(b.splice(a,1),--a,--r);for(c=0;c<r;++c){b[c].classList?(b[c].classList.remove(d.firstItemClass),b[c].classList.remove(d.lastRowClass)):b[c].className=b[c].className.replace(new RegExp("(^|\\b)"+d.firstItemClass+"|"+d.lastRowClass+"(\\b|$)","gi"),
" ");f+=h[c].width;e.push(b[c]);if(c===r-1)for(a=0;a<e.length;a++){0===a&&(e[a].className+=" "+d.lastRowClass);var l="width: "+h[c+parseInt(a)-e.length+1].width+"px;height: "+h[c+parseInt(a)-e.length+1].height+"px;";a<e.length-1&&(l+="margin-right:"+d.minMargin+"px");e[a].style.cssText=l}if(f+d.maxMargin*(e.length-1)>g||singleImagePerRow){k=f+d.maxMargin*(e.length-1)-g;a=e.length;(d.maxMargin-d.minMargin)*(a-1)<k?(q=d.minMargin,k-=(d.maxMargin-d.minMargin)*(a-1)):(q=d.maxMargin-k/(a-1),k=0);var n=
null,p=0;for(a=0;a<e.length;a++){var t=e[a];l=h[c+parseInt(a)-e.length+1].width;var m=l-l/f*k;n=n||Math.round(h[c+parseInt(a)-e.length+1].height*(m/l));.5<=p+1-m%1?(p-=m%1,m=Math.floor(m)):(p+=1-m%1,m=Math.ceil(m));l="width: "+m+"px;height: "+n+"px;";a<e.length-1&&(l+="margin-right: "+q+"px");t.style.cssText=l;0===a&&d.firstItemClass&&(t.className+=" "+d.firstItemClass)}e=[];f=0}}}if(null!==f&&void 0!==f)if("appended"===b){b=JSON.parse(f.getAttribute("data-row-grid"));var p=f.getElementsByClassName(b.lastRowClass)[0];
p=u(p);n(f,b,p)}else b?(void 0===b.minWidth&&(b.minWidth=0),void 0===b.lastRowClass&&(b.lastRowClass="last-row"),f.setAttribute("data-row-grid",JSON.stringify(b)),window.addEventListener("resize",function(g){n(f,b)})):b=JSON.parse(f.getAttribute("data-row-grid")),n(f,b)};"object"===typeof exports&&(module.exports=rowGrid);