var rowGrid=function(f,a){function u(a){for(var d=[a];(a=a.nextSibling)&&9!==a.nodeType;)1===a.nodeType&&d.push(a);return d}function p(a,d,g){var f=0,e=[];g=Array.prototype.slice.call(g||a.querySelectorAll(d.itemSelector));var r=g.length;singleImagePerRow=!!window.matchMedia&&!window.matchMedia("(min-width:"+d.minWidth+"px)").matches;var h=getComputedStyle(a);a=Math.floor(a.getBoundingClientRect().width)-parseFloat(h.getPropertyValue("padding-left"))-parseFloat(h.getPropertyValue("padding-right"));
h=[];for(var c,k,q,b=0;b<r;++b)(c=g[b].getElementsByTagName("img")[0])?((k=parseInt(c.getAttribute("width")))||c.setAttribute("width",k=c.offsetWidth),(q=parseInt(c.getAttribute("height")))||c.setAttribute("height",q=c.offsetHeight),h[b]={width:k,height:q}):(g.splice(b,1),--b,--r);for(c=0;c<r;++c){g[c].classList?(g[c].classList.remove(d.firstItemClass),g[c].classList.remove(d.lastRowClass)):g[c].className=g[c].className.replace(new RegExp("(^|\\b)"+d.firstItemClass+"|"+d.lastRowClass+"(\\b|$)","gi"),
" ");f+=h[c].width;e.push(g[c]);if(c===r-1)for(b=0;b<e.length;b++){0===b&&(e[b].className+=" "+d.lastRowClass);var l="width: "+h[c+parseInt(b)-e.length+1].width+"px;height: "+h[c+parseInt(b)-e.length+1].height+"px;";b<e.length-1&&(l+="margin-right:"+d.minMargin+"px");e[b].style.cssText=l}if(f+d.maxMargin*(e.length-1)>a||singleImagePerRow){k=f+d.maxMargin*(e.length-1)-a;b=e.length;(d.maxMargin-d.minMargin)*(b-1)<k?(q=d.minMargin,k-=(d.maxMargin-d.minMargin)*(b-1)):(q=d.maxMargin-k/(b-1),k=0);var p=
null,n=0;for(b=0;b<e.length;b++){var t=e[b];l=h[c+parseInt(b)-e.length+1].width;var m=l-l/f*k;p=p||Math.round(h[c+parseInt(b)-e.length+1].height*(m/l));.5<=n+1-m%1?(n-=m%1,m=Math.floor(m)):(n+=1-m%1,m=Math.ceil(m));l="width: "+m+"px;height: "+p+"px;";b<e.length-1&&(l+="margin-right: "+q+"px");t.style.cssText=l;0===b&&d.firstItemClass&&(t.className+=" "+d.firstItemClass)}e=[];f=0}}}if(null!==f&&void 0!==f)if("appended"===a){a=JSON.parse(f.getAttribute("data-row-grid"));var n=f.getElementsByClassName(a.lastRowClass)[0];
n=u(n);p(f,a,n)}else a?(void 0===a.resize&&(a.resize=!0),void 0===a.minWidth&&(a.minWidth=0),void 0===a.lastRowClass&&(a.lastRowClass="last-row")):a=JSON.parse(f.getAttribute("data-row-grid")),p(f,a),f.setAttribute("data-row-grid",JSON.stringify(a)),a.resize&&window.addEventListener("resize",function(n){p(f,a)})};"object"===typeof exports&&(module.exports=rowGrid);